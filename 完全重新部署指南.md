# 完全重新部署指南

## 📋 当前状态

✅ 所有代码已推送到 GitHub (commit: `3b0b2a5`)
✅ Dockerfile 配置正确（包含 OpenSSL 修复）
✅ 所有依赖包已正确配置

## 🚀 完全重新部署步骤

### 方法 1: 在 Zeabur 控制台强制重新部署（推荐）

1. **进入 Zeabur 控制台**
   - 访问：https://dash.zeabur.com
   - 登录你的账号

2. **进入服务页面**
   - 点击项目：`xhs`
   - 点击服务：`xiaohongshu-content-generator`

3. **停止所有旧部署**
   - 进入 `Deployments` 标签页
   - 找到所有运行中的部署
   - 对每个运行中的部署，点击右侧三个点菜单 (⋮)
   - 选择 `Stop` 或 `停止`
   - 等待所有部署停止

4. **触发完全重新部署**
   - 在服务页面，点击 `Redeploy` 或 `重新部署` 按钮
   - 如果有 `Force Rebuild` 或 `强制重建` 选项，请勾选
   - 确认开始新的部署

5. **等待构建完成**
   - 查看构建日志（点击 `Logs` 或 `日志`）
   - 确认构建成功
   - 查看运行时日志，确认应用正常启动

### 方法 2: 删除并重新创建服务（完全重置）

如果方法 1 不行，可以完全删除服务后重新创建：

1. **删除现有服务**
   - 进入服务 `xiaohongshu-content-generator`
   - 进入 `Settings` 或 `设置` 页面
   - 找到 `Delete Service` 或 `删除服务`
   - 确认删除

2. **重新创建服务**
   - 在项目页面，点击 `Add Service` 或 `添加服务`
   - 选择 `From GitHub` 或 `从 GitHub`
   - 选择仓库：`percychen19-max/xiaohongshu-content-generator`
   - 设置 Root Directory：`web 2`
   - 配置环境变量（参考下面的环境变量列表）
   - 开始部署

## 📋 环境变量配置

确保以下环境变量已正确配置：

```
PORT=3000
DATABASE_URL=从Zeabur的PostgreSQL服务复制
JWT_SECRET=请填写一个随机长字符串（至少32位，生产环境务必更换）
NODE_ENV=production
ADMIN_USERNAME=admin
ADMIN_PASSWORD=请设置强密码（生产环境务必更换）
COPY_ENGINE_VENDOR=google
COPY_ENGINE_BASE_URL=https://gitaigc.com/v1
COPY_ENGINE_MODEL_ID=gemini-1.5-pro-latest
GOOGLE_API_KEY=你的Google_API_Key
IMAGE_ENGINE_VENDOR=google
IMAGE_ENGINE_BASE_URL=https://gitaigc.com/v1
IMAGE_ENGINE_MODEL_ID=gemini-2.5-flash-image
DASHSCOPE_API_KEY=你的DashScope_API_Key
DASHSCOPE_BASE_URL=https://dashscope.aliyuncs.com/api/v1
```

## ✅ 验证清单

部署完成后，请检查：

- [ ] 构建日志显示构建成功
- [ ] 没有 TypeScript 编译错误
- [ ] 没有 Prisma OpenSSL 错误
- [ ] 应用成功启动（查看运行时日志）
- [ ] 可以访问应用 URL

## 🔍 如果还有问题

如果新的部署仍然失败，请提供：

1. **完整的构建日志**（特别是错误部分）
2. **运行时日志**（应用启动后的日志）
3. **具体的错误信息**（错误类型、文件路径、行号）

## 📝 最新代码包含的修复

- ✅ OpenSSL 1.1.x 兼容库安装
- ✅ 库路径环境变量设置
- ✅ TypeScript 类型错误修复
- ✅ 所有依赖包正确配置（Tailwind CSS、TypeScript、Prisma）



